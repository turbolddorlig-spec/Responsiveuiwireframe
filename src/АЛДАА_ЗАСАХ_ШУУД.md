# üîß "Failed to fetch" –ê–õ–î–ê–ê–ì –ó–ê–°–ê–•

## üéØ –¢–∞ —è–≥ –æ–¥–æ–æ —Ö–∞—Ä–∂ –±–∞–π–≥–∞–∞ –∞–ª–¥–∞–∞:

```
Error initializing data: {
  "message": "TypeError: Failed to fetch"
}
```

## ‚ö° –®–∞–ª—Ç–≥–∞–∞–Ω (99% –º–∞–≥–∞–¥–ª–∞–ª):

**Supabase database tables “Ø“Ø—Å–≥—ç—ç–≥“Ø–π –±–∞–π–Ω–∞!**

–ê–ø–ø –∞–∂–∏–ª–ª–∞—Ö—ã–Ω —Ç—É–ª–¥ 5 table —Ö—ç—Ä—ç–≥—Ç—ç–π:
- ‚úÖ `user_profiles` - –•—ç—Ä—ç–≥–ª—ç–≥—á–¥–∏–π–Ω –º—ç–¥—ç—ç–ª—ç–ª
- ‚úÖ `products` - –ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω“Ø“Ø–¥
- ‚úÖ `orders` - –ó–∞—Ö–∏–∞–ª–≥—É—É–¥
- ‚úÖ `driver_leads` - –ñ–æ–ª–æ–æ—á–∏–π–Ω —Ö“Ø—Å—ç–ª—Ç“Ø“Ø–¥
- ‚úÖ `stocks` - –ê–≥—É—É–ª–∞—Ö—ã–Ω –Ω”©”©—Ü

---

## üöÄ –®–ò–ô–î–≠–õ - 2 –ê–†–ì–ê

### –ê–†–ì–ê 1: Setup —à–∞–ª–≥–∞—Ö —Ç–æ–≤—á –∞—à–∏–≥–ª–∞—Ö (–•–∞–º–≥–∏–π–Ω —Ö—è–ª–±–∞—Ä)

1. **Browser –¥—ç—ç—Ä—Ö –∞–ª–¥–∞–∞–Ω—ã –º–µ—Å—Å–µ–∂ —Ö–∞—Ä–∞—Ö**
2. **"Database —Ö–æ–ª–±–æ–≥–¥–æ—Ö–≥“Ø–π –±–∞–π–Ω–∞" toast message** –≥–∞—Ä—Å–∞–Ω –±–æ–ª:
   - Browser –¥—ç—ç—Ä **F5** –¥–∞—Ä–∂ refresh —Ö–∏–π—Ö
3. **–ù—ç–≤—Ç—Ä—ç—Ö –¥—ç–ª–≥—ç—Ü** —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞
4. **üîç "Setup —à–∞–ª–≥–∞—Ö (–≠—Ö–ª—ç—ç–¥ —ç–Ω–∏–π–≥ –¥–∞—Ä–Ω–∞ —É—É!)"** –Ω–æ–≥–æ–æ–Ω —Ç–æ–≤—á –¥–∞—Ä–∞—Ö
5. **Setup Diagnostic** —Ü–æ–Ω—Ö –Ω—ç—ç–≥–¥—ç–Ω—ç
6. **"Setup —à–∞–ª–≥–∞—Ö"** —Ç–æ–≤—á –¥–∞—Ä–∞—Ö
7. **–ê–ª–¥–∞–∞–Ω—É—É–¥—ã–≥ —Ö–∞—Ä–∞—Ö** - –¥–æ–æ—Ä—Ö "–®–∏–π–¥—ç–ª:" —Ö—ç—Å–≥–∏–π–≥ –¥–∞–≥–∞—Ö

---

### –ê–†–ì–ê 2: –ì–∞—Ä–∞–∞—Ä SQL –∞–∂–∏–ª–ª—É—É–ª–∞—Ö (–ë“Ø—Ä—ç–Ω —Ö—è–Ω–∞–ª—Ç)

#### üìù –ê–ª—Ö–∞–º 1: Supabase Dashboard –Ω—ç—ç—Ö

```
https://supabase.com/dashboard
```

1. ”®”©—Ä–∏–π–Ω Project —Å–æ–Ω–≥–æ—Ö
2. –ó“Ø“Ø–Ω —Ü—ç—Å –¥—ç—ç—Ä **SQL Editor** –¥–∞—Ä–∞—Ö
3. **"New query"** —Ç–æ–≤—á –¥–∞—Ä–∞—Ö

---

#### üìù –ê–ª—Ö–∞–º 2: SQL –∫–æ–¥ —Ö—É—É–ª–∞—Ö

**–®–£–£–î_–ó–ê–°–ê–•.md** —Ñ–∞–π–ª –Ω—ç—ç–∂ **–ê–õ–•–ê–ú 1** –¥–∞—Ö—å SQL –∫–æ–¥—ã–≥ –±“Ø—Ç—ç–Ω —Ö—É—É–ª–Ω–∞.

–≠—Å–≤—ç–ª –¥–æ–æ—Ä—Ö –∫–æ–¥—ã–≥ —Ö—É—É–ª–Ω–∞:

```sql
-- ============================================================================
-- COMPLETE SUPABASE SETUP
-- ============================================================================

-- Enable extensions
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE EXTENSION IF NOT EXISTS "pgcrypto";

-- User Profiles Table
CREATE TABLE IF NOT EXISTS user_profiles (
    id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
    phone TEXT UNIQUE NOT NULL,
    name TEXT NOT NULL,
    role TEXT NOT NULL CHECK (role IN ('super_admin', 'admin', 'operator', 'driver', 'driver_lead', 'accounting', 'warehouse')),
    driver_name TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Products Table
CREATE TABLE IF NOT EXISTS products (
    id SERIAL PRIMARY KEY,
    code TEXT UNIQUE NOT NULL,
    name TEXT NOT NULL,
    size TEXT,
    color TEXT,
    price NUMERIC(12, 0) NOT NULL DEFAULT 0,
    description TEXT,
    image_url TEXT,
    stock INTEGER DEFAULT 0,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Orders Table
CREATE TABLE IF NOT EXISTS orders (
    id SERIAL PRIMARY KEY,
    code TEXT UNIQUE NOT NULL,
    customer_phone TEXT,
    total_price NUMERIC(12, 0) DEFAULT 0,
    status TEXT DEFAULT 'NEW' CHECK (status IN ('NEW', 'IN_TRANSIT', 'DELIVERED', 'CANCELLED')),
    payment_status TEXT DEFAULT 'UNPAID' CHECK (payment_status IN ('PAID', 'UNPAID', 'PARTIAL')),
    payment_method TEXT CHECK (payment_method IN ('CASH', 'CARD', 'TRANSFER', 'QPAY')),
    delivery_date TEXT,
    delivery_time TEXT,
    address TEXT,
    district TEXT,
    khoroo TEXT,
    driver_id UUID REFERENCES user_profiles(id),
    notes TEXT,
    products JSONB DEFAULT '[]'::JSONB,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Driver Leads Table
CREATE TABLE IF NOT EXISTS driver_leads (
    id SERIAL PRIMARY KEY,
    name TEXT,
    phone TEXT NOT NULL,
    district TEXT,
    province TEXT,
    note TEXT,
    status TEXT DEFAULT 'OPEN' CHECK (status IN ('OPEN', 'CONTACTED', 'CLOSED')),
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Stocks Table
CREATE TABLE IF NOT EXISTS stocks (
    id SERIAL PRIMARY KEY,
    product_code TEXT NOT NULL,
    qty INTEGER NOT NULL DEFAULT 0,
    warehouse TEXT NOT NULL,
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    CONSTRAINT positive_qty CHECK (qty >= 0)
);

-- Create indexes
CREATE INDEX IF NOT EXISTS idx_user_profiles_phone ON user_profiles(phone);
CREATE INDEX IF NOT EXISTS idx_products_code ON products(code);
CREATE INDEX IF NOT EXISTS idx_orders_code ON orders(code);
CREATE INDEX IF NOT EXISTS idx_orders_status ON orders(status);
CREATE INDEX IF NOT EXISTS idx_stocks_product_code ON stocks(product_code);

-- Updated at trigger
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$$ language 'plpgsql';

CREATE TRIGGER update_user_profiles_updated_at BEFORE UPDATE ON user_profiles FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_products_updated_at BEFORE UPDATE ON products FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_orders_updated_at BEFORE UPDATE ON orders FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_stocks_updated_at BEFORE UPDATE ON stocks FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

-- Enable RLS
ALTER TABLE user_profiles ENABLE ROW LEVEL SECURITY;
ALTER TABLE products ENABLE ROW LEVEL SECURITY;
ALTER TABLE orders ENABLE ROW LEVEL SECURITY;
ALTER TABLE driver_leads ENABLE ROW LEVEL SECURITY;
ALTER TABLE stocks ENABLE ROW LEVEL SECURITY;

-- RLS Policies
CREATE POLICY "Allow authenticated users to view profiles" ON user_profiles FOR SELECT TO authenticated USING (true);
CREATE POLICY "Allow users to update own profile" ON user_profiles FOR UPDATE TO authenticated USING (auth.uid() = id);
CREATE POLICY "Allow all authenticated users to view products" ON products FOR SELECT TO authenticated USING (true);
CREATE POLICY "Allow admins to manage products" ON products FOR ALL TO authenticated USING (EXISTS (SELECT 1 FROM user_profiles WHERE id = auth.uid() AND role IN ('super_admin', 'admin', 'warehouse')));
CREATE POLICY "Allow authenticated users to view orders" ON orders FOR SELECT TO authenticated USING (EXISTS (SELECT 1 FROM user_profiles WHERE id = auth.uid() AND (role IN ('super_admin', 'admin', 'operator', 'driver_lead', 'accounting') OR (role = 'driver' AND driver_id = auth.uid()))));
CREATE POLICY "Allow admins and operators to manage orders" ON orders FOR ALL TO authenticated USING (EXISTS (SELECT 1 FROM user_profiles WHERE id = auth.uid() AND role IN ('super_admin', 'admin', 'operator')));
CREATE POLICY "Allow authenticated users to view stocks" ON stocks FOR SELECT TO authenticated USING (true);
CREATE POLICY "Allow warehouse to manage stocks" ON stocks FOR ALL TO authenticated USING (EXISTS (SELECT 1 FROM user_profiles WHERE id = auth.uid() AND role IN ('super_admin', 'admin', 'warehouse')));
CREATE POLICY "Allow authenticated users to view driver leads" ON driver_leads FOR SELECT TO authenticated USING (true);
CREATE POLICY "Allow admins to manage driver leads" ON driver_leads FOR ALL TO authenticated USING (EXISTS (SELECT 1 FROM user_profiles WHERE id = auth.uid() AND role IN ('super_admin', 'admin', 'driver_lead')));

-- Insert sample products
INSERT INTO products (code, name, size, color, price, description, stock) VALUES
('PRD001', '–°“Ø“Ø 1–ª', '1–ª', '–¶–∞–≥–∞–∞–Ω', 3500, '–≠—Ä“Ø“Ø–ª –º—ç–Ω–¥–∏–π–Ω —Å“Ø“Ø', 150),
('PRD002', '–¢–∞–ª—Ö', '500–≥', '–ë–æ—Ä', 2000, '–®–∏–Ω—ç —Ç–∞–ª—Ö', 200),
('PRD003', '–¢”©–º—Å', '1–∫–≥', '–®–∞—Ä', 1500, '–®–∏–Ω—ç —Ç”©–º—Å', 300),
('PRD004', '–õ—É—É–≤–∞–Ω', '1–∫–≥', '–£–ª–∞–∞–Ω', 2500, '–®–∏–Ω—ç –ª—É—É–≤–∞–Ω', 100),
('PRD005', '–°–æ–Ω–≥–∏–Ω–æ', '1–∫–≥', '–£–ª–∞–∞–Ω', 1800, '–®–∏–Ω—ç —Å–æ–Ω–≥–∏–Ω–æ', 150),
('PRD006', '”®–Ω–¥”©–≥', '30—à', '–¶–∞–≥–∞–∞–Ω', 12000, '–®–∏–Ω—ç ”©–Ω–¥”©–≥', 80),
('PRD007', '–ì—É—Ä–∏–ª', '1–∫–≥', '–¶–∞–≥–∞–∞–Ω', 2200, '–¶–∞–≥–∞–∞–Ω –≥—É—Ä–∏–ª', 250),
('PRD008', '–ë—É–¥–∞–∞', '1–∫–≥', '–¶–∞–≥–∞–∞–Ω', 3000, '–ß–∞–Ω–∞—Ä—Ç–∞–π –±—É–¥–∞–∞', 180),
('PRD009', '–≠–ª—Å—ç–Ω —á–∏—Ö—ç—Ä', '1–∫–≥', '–¶–∞–≥–∞–∞–Ω', 2800, '–≠–ª—Å—ç–Ω —á–∏—Ö—ç—Ä', 120),
('PRD010', '–¢–æ—Å', '1–ª', '–®–∞—Ä', 8500, '–£—Ä–≥–∞–º–ª—ã–Ω —Ç–æ—Å', 90)
ON CONFLICT (code) DO NOTHING;
```

---

#### üìù –ê–ª—Ö–∞–º 3: SQL –∞–∂–∏–ª–ª—É—É–ª–∞—Ö

1. SQL Editor –¥—ç—ç—Ä **Ctrl+V** (Mac: **Cmd+V**) –¥–∞—Ä–∂ paste —Ö–∏–π—Ö
2. **RUN** ‚ñ∂Ô∏è —Ç–æ–≤—á –¥–∞—Ä–∞—Ö (–±–∞—Ä—É—É–Ω –¥—ç—ç–¥ —Ç–∞–ª–¥)
3. **Success!** –≥—ç—Ö –º–µ—Å—Å–µ–∂ —Ö–∞—Ä–∞—Ö

‚úÖ –ê–º–∂–∏–ª—Ç—Ç–∞–π! Tables “Ø“Ø—Å–ª—ç—ç!

---

#### üìù –ê–ª—Ö–∞–º 4: Demo —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥ “Ø“Ø—Å–≥—ç—Ö

1. **Authentication ‚Üí Users** —Ä—É—É –æ—á–∏—Ö
2. **"Add user" ‚Üí "Create new user"** –¥–∞—Ä–∞—Ö

–î–∞—Ä–∞–∞—Ö —Ö—ç—Ä—ç–≥–ª—ç–≥—á–¥–∏–π–≥ “Ø“Ø—Å–≥—ç—Ö (**Auto Confirm User = YES!**):

| Email | Password |
|-------|----------|
| 99000000@logistics.mn | super123 |
| 99000002@logistics.mn | operator123 |
| 99112233@logistics.mn | driver123 |

---

#### üìù –ê–ª—Ö–∞–º 5: User Profiles —Ö–æ–ª–±–æ—Ö

1. **Authentication ‚Üí Users** –¥—ç—ç—Ä —Ö—ç—Ä—ç–≥–ª—ç–≥—á –±“Ø—Ä–∏–π–Ω **UUID** —Ö—É—É–ª–∞—Ö
2. **SQL Editor** –¥—ç—ç—Ä –¥–∞—Ä–∞–∞—Ö SQL –∞–∂–∏–ª–ª—É—É–ª–∞—Ö (UUID-–≥ ”©”©—Ä–∏–π–Ω—Ö”©”©—Ä —Å–æ–ª–∏—Ö!):

```sql
-- Super Admin (PASTE UUID BELOW)
INSERT INTO user_profiles (id, phone, name, role) VALUES
('PASTE_SUPER_ADMIN_UUID_HERE', '99000000', '–°—É–ø–µ—Ä –ê–¥–º–∏–Ω', 'super_admin');

-- Operator
INSERT INTO user_profiles (id, phone, name, role) VALUES
('PASTE_OPERATOR_UUID_HERE', '99000002', '–û–ø–µ—Ä–∞—Ç–æ—Ä –ë–æ–ª–¥', 'operator');

-- Driver
INSERT INTO user_profiles (id, phone, name, role, driver_name) VALUES
('PASTE_DRIVER_UUID_HERE', '99112233', '–ñ–æ–ª–æ–æ—á –ë–∞—Ç', 'driver', '–ë–∞—Ç');
```

---

#### üìù –ê–ª—Ö–∞–º 6: Refresh & Login

1. Browser –¥—ç—ç—Ä **F5** –¥–∞—Ä–∞—Ö
2. –ù—ç–≤—Ç—Ä—ç—Ö —Ö—É—É–¥–∞—Å —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞
3. **99000000** / **super123** –æ—Ä—É—É–ª–∂ –Ω—ç–≤—Ç—Ä—ç—Ö
4. **üéâ –ê–º–∂–∏–ª—Ç—Ç–∞–π!**

---

## üîç Browser Console —à–∞–ª–≥–∞—Ö

**F12** –¥–∞—Ä–∂ Console-–≥ –Ω—ç—ç. –î–æ–æ—Ä—Ö –º–µ—Å—Å–µ–∂“Ø“Ø–¥ —Ö–∞—Ä–∞–≥–¥–∞—Ö —ë—Å—Ç–æ–π:

```
‚úÖ Supabase Client initialized
   Project ID: ymxwnapkniubgbboupbb
   URL: https://ymxwnapkniubgbboupbb.supabase.co
```

–•—ç—Ä—ç–≤ **—É–ª–∞–∞–Ω –∞–ª–¥–∞–∞** —Ö–∞—Ä–∞–≥–¥–≤–∞–ª:
- Screenshot –∞–≤—á —à–∞–ª–≥–∞—Ö
- –®–£–£–î_–ó–ê–°–ê–•.md –¥–∞—Ö—å troubleshooting “Ø–∑—ç—Ö

---

## üí° –°–∞–Ω–∞–º–∂:

- ‚ùå Edge Functions deploy —Ö—ç—Ä—ç–≥–≥“Ø–π
- ‚ùå Backend server —ç—Ö–ª“Ø“Ø–ª—ç—Ö —Ö—ç—Ä—ç–≥–≥“Ø–π
- ‚ùå Docker —Ö—ç—Ä—ç–≥–≥“Ø–π
- ‚úÖ –ó”©–≤—Ö”©–Ω DATABASE TABLES “Ø“Ø—Å–≥—ç—Ö —Ö—ç—Ä—ç–≥—Ç—ç–π!

---

## üìö –ë—É—Å–∞–¥ —Ñ–∞–π–ª—É—É–¥:

- **–®–£–£–î_–ó–ê–°–ê–•.md** - –î—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π 3-–∞–ª—Ö–∞–º—Ç–∞–π –∑–∞–∞–≤–∞—Ä
- **CREDENTIALS.md** - –ë“Ø—Ö demo —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥
- **SETUP_WALKTHROUGH.md** - –ê–ª—Ö–∞–º –∞–ª—Ö–º–∞–∞—Ä –≥–∞—Ä—ã–Ω –∞–≤–ª–∞–≥–∞
